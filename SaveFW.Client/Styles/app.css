@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom Scrollbar moved to index.html to prevent load shift */
html,
body {
    overflow-x: hidden;
    width: 100%;
}

/* Fix for white outline on Hero text reported by user (often caused by focus on non-interactive elements or strange browser defaults) */
.outline-none-force,
[tabindex="-1"]:focus {
    outline: none !important;
}

@layer components {
    .material-symbols-outlined {
        font-family: 'Material Symbols Outlined Variable';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        -moz-osx-font-smoothing: grayscale;
        font-feature-settings: 'liga';
        font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    }
}

/* Fix for blinking cursor in details/summary expand buttons */
details summary {
    caret-color: transparent;
    user-select: none;
    -webkit-user-select: none;
}

details summary:focus {
    outline: none;
}

.map-tooltip {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    padding: 0 !important;
}

.map-tooltip::before {
    display: none !important;
}

/* Remove default focus outline on map features */
.leaflet-interactive:focus {
    outline: none !important;
}

/* Flipbook / Simple Viewer Styles */
#flipbook-container {
    width: 100%;
    max-width: 1400px;
    height: 80vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
}

.simple-viewer {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.page-spread {
    display: flex;
    gap: 4px;
    max-height: 100%;
    box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
    border-radius: 4px;
    overflow: hidden;
}

.page-left,
.page-right {
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.15s ease, transform 0.15s ease;
    max-height: 80vh;
}

.page-left {
    border-right: 1px solid rgba(0, 0, 0, 0.1);
}

.page-left.flipping,
.page-right.flipping {
    opacity: 0.7;
    transform: scale(0.98);
}

.page-left img,
.page-right img {
    max-width: 100%;
    max-height: 80vh;
    width: auto;
    height: auto;
    object-fit: contain;
    pointer-events: none;
    user-select: none;
    -webkit-user-drag: none;
}

.text-gradient {
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.leaflet-control-geocoder {
    position: relative !important;
    top: auto !important;
    left: auto !important;
    transform: none !important;
    z-index: 90 !important;
    background: white;
    border-radius: 24px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), 0 -1px 0px rgba(0, 0, 0, 0.02) !important;
    border: 1px solid transparent !important;
    display: flex;
    align-items: center;
    padding: 2px 8px !important;
    margin: 0 !important;
    height: 48px;
    min-width: 100%;
    overflow: visible !important;
}

.leaflet-control-geocoder-form {
    flex: 1;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
}

.leaflet-control-geocoder-form input {
    padding: 0 12px !important;
    font-size: 16px !important;
    width: 100% !important;
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
    background: transparent !important;
    height: 100% !important;
    color: #1f2937;
}

.leaflet-control-geocoder-form input:focus {
    outline: none !important;
    box-shadow: none !important;
    border: none !important;
}

/* Search Results Dropdown */
.leaflet-control-geocoder-alternatives {
    width: 100%;
    background: white !important;
    border-radius: 12px !important;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05) !important;
    margin-top: 12px !important;
    padding: 0 !important;
    list-style: none !important;
    overflow: hidden !important;
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    z-index: 2000 !important;
    border: 1px solid #e2e8f0 !important;
}

.leaflet-control-geocoder-alternatives li {
    padding: 12px 16px !important;
    border-bottom: 1px solid #f1f5f9 !important;
    cursor: pointer !important;
    font-size: 14px !important;
    color: #334155 !important;
    transition: background-color 0.2s ease !important;
    text-align: left !important;
}

.leaflet-control-geocoder-alternatives li:hover,
.leaflet-control-geocoder-selected {
    background-color: #f8fafc !important;
    color: #0f172a !important;
}

.leaflet-control-geocoder-alternatives li:last-child {
    border-bottom: none !important;
}

.leaflet-control-geocoder-alternatives a {
    text-decoration: none !important;
    color: inherit !important;
    display: block;
}

.leaflet-control-geocoder-icon {
    display: none !important;
}

.leaflet-control-geocoder::before {
    content: 'search';
    font-family: 'Material Symbols Outlined';
    font-size: 20px;
    color: #94a3b8;
    margin-left: 8px;
    display: block;
}

.leaflet-control-geocoder-throbber {
    border: none !important;
}

/* --- SIREN LIGHT --- */
.siren-wrapper {
    position: absolute;
    top: -55px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 60px;
    z-index: 5;
    overflow: visible;
    perspective: 1200px;
}

.siren-wrapper::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 3000px;
    height: 3000px;
    background: conic-gradient(from 0deg,
            transparent 0deg,
            rgba(255, 0, 0, 0) 50deg,
            rgba(255, 20, 20, 0.1) 70deg,
            rgba(255, 50, 50, 0.6) 90deg,
            rgba(255, 20, 20, 0.1) 110deg,
            rgba(255, 0, 0, 0) 130deg,
            transparent 180deg,
            rgba(255, 0, 0, 0) 230deg,
            rgba(255, 20, 20, 0.1) 250deg,
            rgba(255, 50, 50, 0.6) 270deg,
            rgba(255, 20, 20, 0.1) 290deg,
            rgba(255, 0, 0, 0) 310deg,
            transparent 360deg);
    transform-origin: center center;
    opacity: 0;
    pointer-events: none;
    z-index: 100;
    mix-blend-mode: screen;
    transition: opacity 0.5s;
    transform: translate(-50%, -50%) rotateX(75deg) rotate(0deg);
}

.siren-wrapper.siren-active::after {
    opacity: 1;
    animation: beam-spin 2s linear infinite;
}

@keyframes beam-spin {
    from {
        transform: translate(-50%, -50%) rotateX(75deg) rotate(0deg);
    }

    to {
        transform: translate(-50%, -50%) rotateX(75deg) rotate(360deg);
    }
}

.siren-base {
    width: 80px;
    height: 12px;
    background: linear-gradient(to bottom, #444, #111);
    border-radius: 4px;
    border: 1px solid #555;
    position: absolute;
    bottom: 0;
    left: 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    z-index: 2;
}

.siren-bulb {
    width: 60px;
    height: 48px;
    background: radial-gradient(circle at 30% 30%, #660000, #330000);
    border-radius: 50% 50% 15% 15%;
    margin: 0 auto;
    position: relative;
    top: 2px;
    border: 1px solid #440000;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.8);
    transition: all 0.3s;
    overflow: hidden;
}

.siren-wrapper.siren-active .siren-bulb {
    background-color: #cc0000;
    background-image: linear-gradient(110deg,
            rgba(204, 0, 0, 0) 30%,
            rgba(255, 100, 100, 0.8) 45%,
            rgba(255, 255, 255, 1) 50%,
            rgba(255, 100, 100, 0.8) 55%,
            rgba(204, 0, 0, 0) 70%);
    background-size: 300% 100%;
    box-shadow: 0 0 60px #ff0000, 0 0 20px #ff3333 inset;
    border-color: #ff5555;
    animation: lighthouse-sweep 1s linear infinite;
}

@keyframes lighthouse-sweep {
    0% {
        background-position: 100% 0;
    }

    100% {
        background-position: -50% 0;
    }
}

/* --- SLOT MACHINE CONTAINER --- */
.slot-machine-wrapper {
    background: linear-gradient(135deg, #bfa05d 0%, #ffebcd 50%, #bfa05d 100%);
    padding: clamp(10px, 4vw, 40px);
    padding-top: 120px;
    border-radius: 50% 50% 20px 20px / 100px 100px 20px 20px;
    border: 4px solid #a67c00;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.5), inset 0 0 20px rgba(255, 255, 255, 0.3);
    text-align: center;
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    position: relative;
    z-index: 10;
    user-select: none;
    overflow: visible !important;
}

.payline-marker {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 40;
    display: flex;
    align-items: center;
}

.marker-left {
    left: -20px;
}

.marker-right {
    right: -20px;
    flex-direction: row-reverse;
}

.marker-base {
    width: 20px;
    height: 30px;
    background: linear-gradient(to right, #2a0a0a, #5c1818);
    border: 1px solid #000;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.8);
}

.marker-tip {
    width: 20px;
    height: 24px;
    background: linear-gradient(135deg, #ef4444, #991b1b);
    clip-path: polygon(0 0, 100% 50%, 0 100%);
    filter: drop-shadow(4px 4px 4px rgba(0, 0, 0, 0.8));
}

.marker-right .marker-tip {
    transform: rotate(180deg);
    filter: drop-shadow(-4px -4px 4px rgba(0, 0, 0, 0.8));
}

.marquee-logo {
    position: relative;
    margin: -110px auto 20px;
    width: 90%;
    max-width: 650px;
    height: 100px;
    z-index: 20;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #bfa05d;
    border-radius: 50% 50% 0 0 / 100px 100px 0 0;
    box-shadow: inset 0 15px 20px rgba(0, 0, 0, 0.3), inset 0 0 15px rgba(0, 0, 0, 0.1), inset 0 -1px 3px rgba(255, 255, 255, 0.3), 0 2px 4px rgba(0, 0, 0, 0.3);
    border: 4px solid #5c4a00;
    border-bottom: none;
    overflow: visible;
}

.marquee-logo::before {
    content: '';
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(90deg, transparent, transparent 4px, rgba(0, 0, 0, 0.05) 4px, rgba(0, 0, 0, 0.05) 5px);
    opacity: 0.2;
    pointer-events: none;
    border-radius: inherit;
    overflow: hidden;
}

.marquee-logo img {
    position: relative;
    z-index: 30;
    width: auto;
    max-width: 95%;
    height: 130%;
    margin-top: -5px;
    filter: drop-shadow(0 4px 1px rgba(0, 0, 0, 0.7)) drop-shadow(0 8px 12px rgba(0, 0, 0, 0.4));
}

.casino-lights {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 100%;
    padding: 0;
    margin: 0;
    list-style: none;
    pointer-events: none;
    z-index: 50;
}

.casino-lights li {
    position: absolute;
    width: 20px;
    height: 20px;
    margin-left: -10px;
    margin-top: -10px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 1) 0%, rgba(255, 245, 200, 0.95) 20%, rgba(255, 210, 100, 0.9) 40%, rgba(255, 170, 50, 0.8) 60%, rgba(255, 120, 20, 0.6) 80%, rgba(200, 80, 0, 0.4) 100%);
    box-shadow: inset -2px -2px 4px rgba(255, 200, 100, 0.4), inset 2px 2px 3px rgba(255, 255, 255, 0.8), 0 0 8px 3px rgba(255, 180, 50, 0.9), 0 0 16px 6px rgba(255, 150, 0, 0.6), 0 0 28px 10px rgba(255, 100, 0, 0.35);
    border: 1px solid rgba(255, 200, 100, 0.7);
    transition: all 0.15s ease-out;
}

.casino-lights li::after {
    content: '';
    position: absolute;
    top: 3px;
    left: 4px;
    width: 5px;
    height: 5px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.5) 40%, transparent 100%);
    border-radius: 50%;
}

.casino-lights li.bulb-off {
    background: radial-gradient(circle at 30% 30%, rgba(120, 110, 90, 0.6) 0%, rgba(90, 80, 60, 0.5) 40%, rgba(60, 50, 35, 0.5) 80%, rgba(40, 30, 20, 0.4) 100%);
    box-shadow: inset -1px -1px 3px rgba(0, 0, 0, 0.2), inset 1px 1px 2px rgba(255, 255, 255, 0.1), 0 1px 3px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(80, 60, 40, 0.5);
}

.casino-lights li.bulb-red {
    background: radial-gradient(circle at 30% 30%, rgba(255, 50, 50, 1) 0%, rgba(220, 0, 0, 0.95) 40%, rgba(180, 0, 0, 0.9) 100%);
    box-shadow: 0 0 10px 4px rgba(255, 0, 0, 0.8), 0 0 20px 8px rgba(200, 0, 0, 0.6);
    border: 1px solid rgba(255, 100, 100, 0.8);
}

.casino-lights li.bulb-red.bulb-off {
    background: radial-gradient(circle at 30% 30%, rgba(100, 20, 20, 0.6) 0%, rgba(80, 10, 10, 0.5) 40%, rgba(50, 5, 5, 0.5) 80%, rgba(30, 0, 0, 0.4) 100%);
    box-shadow: inset -1px -1px 3px rgba(0, 0, 0, 0.3), inset 1px 1px 2px rgba(255, 100, 100, 0.1), 0 1px 3px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(80, 20, 20, 0.5);
}

.lever-container {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    margin-top: 50px;
    right: -60px;
    width: 80px;
    height: 200px;
    z-index: auto;
    perspective: 600px;
}

.lever-base {
    position: absolute;
    bottom: 20px;
    left: -10px;
    width: 80px;
    height: 60px;
    background: linear-gradient(135deg, #bfa05d 0%, #a67c00 100%);
    border-top-right-radius: 10px;
    border-bottom-right-radius: 10px;
    border: 2px solid #8c6a00;
    border-left: none;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
    z-index: -1;
}

.lever-arm {
    position: absolute;
    bottom: 50px;
    left: 35px;
    width: 12px;
    height: 160px;
    background: linear-gradient(to right, #e2e8f0, #fff, #94a3b8);
    transform-origin: bottom center;
    transform: rotateX(0deg);
    transform-style: preserve-3d;
    border-radius: 6px;
    box-shadow: -2px 0 5px rgba(0, 0, 0, 0.2);
    cursor: grab;
    transition: transform 0.1s ease-out;
    will-change: transform;
    z-index: 20;
}

.lever-arm:active {
    cursor: grabbing;
}

.lever-knob {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%) translateZ(10px);
    width: 60px;
    height: 60px;
    background: radial-gradient(circle at 30% 30%, #ff4444, #990000);
    border-radius: 50%;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4), inset 2px 2px 5px rgba(255, 255, 255, 0.2);
    border: 1px solid #cc0000;
    z-index: 20;
    transform-style: preserve-3d;
    will-change: transform;
    display: flex;
    align-items: center;
    justify-content: center;
}

.knob-text {
    font-family: 'Public Sans', sans-serif;
    color: #ffffff;
    font-size: 11px;
    font-weight: 900;
    line-height: 1.0;
    text-align: center;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    pointer-events: none;
    user-select: none;
    transform: translateZ(1px);
}

.lever-pulled {
    animation: pullLever 0.6s cubic-bezier(0.25, 1, 0.5, 1) forwards;
}

.lever-pulled .lever-knob {
    animation: counterRotateKnob 0.6s cubic-bezier(0.25, 1, 0.5, 1) forwards;
}

@keyframes pullLever {
    0% {
        transform: rotateX(0deg);
    }

    50% {
        transform: rotateX(-70deg);
    }

    100% {
        transform: rotateX(0deg);
    }
}

@keyframes counterRotateKnob {
    0% {
        transform: translateX(-50%) translateZ(10px) rotateX(0deg);
    }

    50% {
        transform: translateX(-50%) translateZ(10px) rotateX(70deg);
    }

    100% {
        transform: translateX(-50%) translateZ(10px) rotateX(0deg);
    }
}

.slot-window {
    display: flex;
    gap: 0;
    height: 280px;
    overflow: hidden;
    background: #0f172a;
    border: 6px solid #8c6a00;
    border-radius: 12px;
    position: relative;
    margin: 0 auto 30px;
    max-width: 650px;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
    perspective: 2000px;
}

.reel-container {
    flex: 1;
    position: relative;
    transform-style: preserve-3d;
    background: transparent;
    border-right: 4px solid #0f172a;
    container-type: inline-size;
}

.reel-container:last-child {
    border-right: none;
}

.reel-strip {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 0;
    transform-style: preserve-3d;
    transition: transform 6s cubic-bezier(0.1, 1, 0.1, 1);
    will-change: transform;
}

.slot-item {
    position: absolute;
    left: 0;
    top: 0;
    height: 80px;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Public Sans', sans-serif;
    font-weight: 900;
    font-size: clamp(10px, 9cqw, 15px);
    text-transform: uppercase;
    color: #064e3b;
    background: linear-gradient(to bottom, #f1f5f9, #fff 40%, #fff 60%, #f1f5f9);
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    box-sizing: border-box;
    backface-visibility: hidden;
    margin-top: -40px;
    padding: 0 10px;
    white-space: normal;
    overflow-wrap: break-word;
    hyphens: auto;
    line-height: 1.1;
    text-align: center;
    letter-spacing: -0.5px;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 1);
}

.truth-word {
    color: #991b1b !important;
    background: linear-gradient(to bottom, #f1f5f9, #fff 40%, #fff 60%, #f1f5f9) !important;
    border-top: 1px solid rgba(0, 0, 0, 0.1) !important;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1) !important;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 1) !important;
    -webkit-text-stroke: 0 !important;
}

.near-miss {
    color: #059669;
}

.reel-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0) 40%, rgba(255, 255, 255, 0.1) 48%, rgba(255, 255, 255, 0.1) 52%, rgba(255, 255, 255, 0) 60%, rgba(255, 255, 255, 0) 100%);
    pointer-events: none;
    z-index: 10;
    transform: translateZ(10px);
}

.reel-controls {
    display: flex;
    justify-content: space-around;
    width: 100%;
    max-width: 650px;
    margin: 20px auto 0;
    padding: 0 20px;
}

.reel-btn {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #ff4444, #990000);
    border: 4px solid #5c0000;
    color: white;
    font-family: 'Public Sans', sans-serif;
    font-weight: 900;
    font-size: 12px;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.5), inset 0 2px 5px rgba(255, 255, 255, 0.4);
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.1s;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

.reel-btn:active {
    transform: translateY(2px);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5), inset 0 2px 5px rgba(0, 0, 0, 0.4);
    background: radial-gradient(circle at 30% 30%, #cc0000, #660000);
}

.info-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    border-radius: 12px;
    background: radial-gradient(circle at 30% 30%, #475569, #0f172a);
    border: 4px solid #020617;
    color: white;
    font-family: 'Public Sans', sans-serif;
    font-weight: 900;
    font-size: 14px;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.5), inset 0 2px 5px rgba(255, 255, 255, 0.2);
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.1s;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    margin-top: 30px;
}

.info-btn:active {
    transform: translateY(2px);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5), inset 0 2px 5px rgba(0, 0, 0, 0.4);
}

.info-btn .material-symbols-outlined {
    font-size: 18px;
}

input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    appearance: none;
    margin: 0;
}

input[type=number] {
    -moz-appearance: textfield;
    appearance: textfield;
}

/* Map Marker Shadow */
.marker-shadow-filter {
    filter: drop-shadow(3px 5px 2px rgba(0, 0, 0, 0.4));
}