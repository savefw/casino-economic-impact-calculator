@inject IJSRuntime JSRuntime

<section class="bg-surface-dark dark:bg-background-dark bg-hero-gradient relative w-full overflow-hidden">
    <div class="mx-auto max-w-7xl flex flex-col lg:flex-row items-center">
        <!-- Text Content -->
        <div class="flex-1 relative z-20 flex flex-col justify-center px-8 py-24 lg:py-32 sm:px-12 lg:px-12 text-white">
            <h1 class="text-4xl font-black leading-tight tracking-tight sm:text-5xl lg:text-6xl mb-6">
                DON'T LET THEM<br />
                <span class="text-accent underline decoration-4 decoration-accent/50 underline-offset-4">GAMBLE
                    AWAY</span><br />
                OUR CITY'S<br />
                FUTURE.
            </h1>
            <h2 class="text-2xl font-bold text-accent mb-6 uppercase tracking-wider">
                Fort Wayne Deserves Better.
            </h2>
            <p class="text-lg text-slate-200 font-medium leading-relaxed mb-10 max-w-xl">
                The proposed casino expansion creates a net fiscal loss for our city, introducing risks of addiction and
                increased crime. Save Fort Wayne has formed a coalition of the willing that bridges political and
                demographic divides. We invite you to join us in defending our community's financial health and
                safety.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 w-full sm:w-auto">
                <!-- Analysis Button -->

                <a class="flex min-h-[56px] w-full sm:w-auto items-center justify-center gap-2 rounded-lg bg-white text-fw-teal dark:text-slate-900 px-6 text-sm font-bold shadow-lg transition-transform active:scale-95 active:bg-slate-100 whitespace-nowrap animate-attention"
                    href="#" onclick="openFlipbook(event)">
                    <span class="material-symbols-outlined text-lg">description</span>
                    Read Independent Analysis
                </a>
                <!-- Email Button -->
                <a href="mailto:outreach@savefw.com"
                    class="flex min-h-[56px] w-full sm:w-auto items-center justify-center gap-2 rounded-lg bg-white text-fw-teal dark:text-slate-900 px-6 text-sm font-bold shadow-lg transition-transform active:scale-95 active:bg-slate-100 whitespace-nowrap">
                    <span class="material-symbols-outlined text-lg">mail</span>
                    Email Us: outreach@savefw.com
                </a>
            </div>

        </div>

        <!-- Image Side -->
        <div class="relative w-full lg:w-1/2">
            <!-- Slot Machine (Moved Here) -->
            <div
                class="relative max-w-[800px] mx-auto z-0 scale-75 sm:scale-90 lg:scale-100 origin-top lg:origin-center mt-6 lg:mt-10">
                <!-- LEVER -->
                <!-- LEVER BASE (Layered Behind) -->
                <div class="lever-container" style="z-index: 0;">
                    <div class="lever-base"></div>
                </div>

                <div class="slot-machine-wrapper">
                    <!-- Siren Light -->
                    <div class="siren-wrapper" id="siren">
                        <div class="siren-base"></div>
                        <div class="siren-bulb"></div>
                    </div>

                    <!-- Marquee Logo -->
                    <div class="marquee-logo">
                        <img src="assets/SAVEFW.svg" alt="Save Fort Wayne" />
                    </div>

                    <!-- Individual Light Bulbs (Generated by JS) -->
                    <ul class="casino-lights" id="casino-lights"></ul>

                    <!-- Window with Payline Markers -->
                    <div class="relative max-w-[650px] mx-auto">
                        <!-- Left Marker -->
                        <div class="payline-marker marker-left">
                            <div class="marker-base"></div>
                            <div class="marker-tip"></div>
                        </div>

                        <!-- Right Marker -->
                        <div class="payline-marker marker-right">
                            <div class="marker-base"></div>
                            <div class="marker-tip"></div>
                        </div>

                        <div class="slot-window">
                            <div class="reel-container">
                                <div class="reel-strip" id="reel-1">
                                </div>
                                <div class="reel-overlay"></div>
                            </div>

                            <div class="reel-container">
                                <div class="reel-strip" id="reel-2"></div>
                                <div class="reel-overlay"></div>
                            </div>

                            <div class="reel-container">
                                <div class="reel-strip" id="reel-3"></div>
                                <div class="reel-overlay"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Reel Control Buttons -->
                    <div class="reel-controls">
                        <button class="reel-btn" @onclick="() => SpinReel(0)">SPIN</button>
                        <button class="reel-btn" @onclick="() => SpinReel(1)">SPIN</button>
                        <button class="reel-btn" @onclick="() => SpinReel(2)">SPIN</button>
                    </div>

                    <!-- Learn More Button -->
                    <button onclick="openSourcesModal()" class="info-btn">
                        <span>About These Words</span>
                        <span class="material-symbols-outlined">arrow_forward</span>
                    </button>

                </div>

                <!-- LEVER ARM (Layered In Front) -->
                <div class="lever-container" style="z-index: 20; pointer-events: none;">
                    <div class="lever-arm" id="slot-lever" style="pointer-events: auto;">
                        <div class="lever-knob">
                            <span class="knob-text">CLICK<br>OR<br>PULL</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JSRuntime.InvokeVoidAsync("window.SlotMachine.init");
        }
    }

    private async Task SpinReel(int index)
    {
        await JSRuntime.InvokeVoidAsync("window.spinReel", index);
    }
}
